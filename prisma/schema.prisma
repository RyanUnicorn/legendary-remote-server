// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Admin {
  password String @id @default("12345678")
}

model Board {
  id    Int     @id @default(autoincrement())
  name  String

  devices Device[]
}

// device in HomeAssistant
model Device {
  // board - relation = device
  board   Board @relation(fields: [boardId], references: [id])
  boardId Int

  identifiers      Int     @id @default(autoincrement())
  name             String
  enableUpdate     Boolean
  blocklyJS        String?
  blocklyWorkspace String?

  entities Entity[]
  irCodes  IrCode[]
}

model IrCode {
  device   Device @relation(fields: [deviceId], references: [identifiers])
  deviceId Int

  id           Int     @id @default(autoincrement())
  name         String  
  description  String?
  rawData      String
}

// entity in HomeAssistant
model Entity {
  // device - relation = entity
  device   Device @relation(fields: [deviceId], references: [identifiers])
  deviceId Int

  uniqueId Int     @id
  name     String
  icon     String?

  // subtypes
  switch Switch?
  select Select?
  button Button?
  number Number?
}

model Switch {
  entity   Entity @relation(fields: [entityId], references: [uniqueId])
  entityId Int    @id

  state Boolean
}

model Select {
  entity   Entity @relation(fields: [entityId], references: [uniqueId])
  entityId Int    @id

  // !!primitive type can't be array!!
  options String
}

model Button {
  entity   Entity @relation(fields: [entityId], references: [uniqueId])
  entityId Int    @id
}

model Number {
  entity   Entity @relation(fields: [entityId], references: [uniqueId])
  entityId Int    @id

  number   Float
  max      Float
  min      Float
  step     Float
  isSlider Boolean
}

// model ac {}
// model fan {}
// model light {}
